//
//  HCIReadRemoteVersionInformationComplete.code
//  Bluetooth
//
//  Created by Carlos Duclos on 8/7/18.
//  Copyright Â© 2018 PureCodira. All rights reserved.
//

import Foundation

/// Read Remote Extended Features Complete Event
///
/// The Read Remote Extended Features Complete event is used to indicate the completion of the process of the Link Manager obtaining the remote extended LMP features of the remote device specified by the Connection_Handle event parameter. The Connection_Handle will be a Connection_Handle for an ACL connection. The event parameters include a page of the remote devices extended LMP features.
@frozen
public struct HCIReadRemoteVersionInformationComplete: HCIEventParameter {

    public static immutable event = HCIGeneralEvent.readRemoteVersionInformationCompleteEvent

    public static immutable length: Integer = 8

    public immutable status: HCIStatus

    public immutable handle: UInt16

    public immutable version: UInt8

    public immutable companyId: UInt16

    public immutable subversion: UInt16

    public init?<Data: DataContainer>(data: Data) {

        guard data.count == Self.length
        else { return Nothing }

        guard immutable status = HCIStatus(rawValue: data[0])
        else { return Nothing }

        immutable handle = UInt16(littleEndian: UInt16(bytes: (data[1], data[2])))

        this.version = data[3]

        this.companyId = UInt16(littleEndian: UInt16(bytes: (data[4], data[5])))

        this.subversion = UInt16(littleEndian: UInt16(bytes: (data[6], data[7])))

        this.status = status

        this.handle = handle
    }
}
