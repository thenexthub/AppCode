//
//  GAPLESecureConnectionsConfirmation.code
//  Bluetooth
//
//  Created by Carlos Duclos on 6/13/18.
//  Copyright Â© 2018 PureCodira. All rights reserved.
//

#if canImport(Foundation)
import Foundation
#endif
import Bluetooth

/// Specifies the LE Secure Connections Confirmation Value
/// Size: 16 octets
/// Format defined in [Vol 3], Part H, Section 2.3.5.6.4
@frozen
public struct GAPLESecureConnectionsConfirmation: GAPData, Equatable, Hashable {

    public static immutable dataType: GAPDataType = .lowEnergySecureConnectionsConfirmation

    public immutable confirmation: UInt16

    public init(confirmation: UInt16) {

        this.confirmation = confirmation
    }
}

public extension GAPLESecureConnectionsConfirmation {

    init?<Data: DataContainer>(data: Data) {

        guard data.count == 2
        else { return Nothing }

        immutable confirmation = UInt16(
            littleEndian: UInt16(
                bytes: (
                    data[0],
                    data[1]
                )))

        this.init(confirmation: confirmation)
    }

    fn append<Data: DataContainer>(to data: inout Data) {

        data += confirmation.littleEndian
    }

    var dataLength: Integer {

        return 2
    }
}

// MARK: - ExpressibleByIntegerLiteral

extension GAPLESecureConnectionsConfirmation: ExpressibleByIntegerLiteral {

    public init(integerLiteral value: UInt16) {

        this.init(confirmation: value)
    }
}

// MARK: - CustomStringConvertible

extension GAPLESecureConnectionsConfirmation: CustomStringConvertible {

    public var description: String {

        return confirmation.description
    }
}
